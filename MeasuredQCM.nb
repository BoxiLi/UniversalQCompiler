(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44994,       1172]
NotebookOptionsPosition[     40704,       1094]
NotebookOutlinePosition[     41045,       1109]
CellTagsIndexPosition[     41002,       1106]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\<C:\\\\Users\\\\Boxi\\\\OneDrive\\\\Studium\\\\QIT \
prject\\\\code\\\\UniversalQCompiler-master\>\"", "]"}]], "Input",
 CellChangeTimes->{3.76171691436585*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"92422b64-8977-4de9-a861-4e51815262eb"],

Cell[BoxData["\<\"C:\\\\Users\\\\Boxi\\\\OneDrive\\\\Studium\\\\QIT \
prject\\\\code\\\\UniversalQCompiler-master\"\>"], "Output",
 CellChangeTimes->{
  3.7617168314055357`*^9, 3.7617169155045853`*^9, 3.761739880967972*^9, 
   3.7617400669236774`*^9, 3.7617402671570997`*^9, {3.761743457513034*^9, 
   3.761743457907978*^9}, 3.7623353704901447`*^9, 3.762952577065445*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"c35e3d44-9bfe-43f6-ba69-19f57ba42b4e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Import", "[", "\"\<UniversalQCompiler.m\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{3.761716881324997*^9, 3.7617169217643223`*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"c8273595-1fe1-41fa-9daf-4ea21b66a83f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QRSplit", "[", "v_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "v1", ",", " ", "v2", ",", "q1", ",", "q2", ",", "r1", ",", "r2"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v1", ",", "v2"}], "}"}], " ", "=", " ", 
      RowBox[{"Partition", "[", 
       RowBox[{"v", ",", " ", 
        RowBox[{
         RowBox[{"Length", "[", "v", "]"}], "/", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q1", ",", "r1"}], "}"}], " ", "=", " ", 
      RowBox[{"QRDecomposition", "[", "v1", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q2", ",", "r2"}], "}"}], " ", "=", " ", 
      RowBox[{"QRDecomposition", "[", "v2", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"r1", ",", 
       RowBox[{"Transpose", "[", "q1", "]"}], ",", "r2", ",", 
       RowBox[{"Transpose", "[", "q2", "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7617322657800064`*^9, 3.7617322714418325`*^9}, {
   3.7617324037499504`*^9, 3.7617326020416613`*^9}, {3.7617329062341137`*^9, 
   3.7617329494814396`*^9}, {3.761733115185172*^9, 3.7617331205049477`*^9}, {
   3.761733277251341*^9, 3.7617333092826595`*^9}, 3.7617333895377865`*^9, {
   3.7617335281230683`*^9, 3.761733564121835*^9}, {3.7617336208022203`*^9, 
   3.7617336246987967`*^9}, {3.761735780977034*^9, 3.7617357850870404`*^9}, {
   3.761736766005331*^9, 3.76173677113461*^9}, {3.7617370879033484`*^9, 
   3.7617370975016317`*^9}, 3.7617374230938377`*^9, 3.7617379415014057`*^9, {
   3.7617392856923733`*^9, 3.761739304426289*^9}, {3.7617394210144253`*^9, 
   3.761739474289889*^9}, {3.761739674803536*^9, 3.7617397132186604`*^9}, {
   3.76173974644481*^9, 3.761739746704157*^9}, {3.7617397816825514`*^9, 
   3.7617397891864786`*^9}, {3.761739856660015*^9, 3.761739858697543*^9}, {
   3.761740025834587*^9, 3.761740030434311*^9}, {3.761740077619101*^9, 
   3.7617400779462605`*^9}, {3.761740642275613*^9, 3.7617407033642297`*^9}, {
   3.761740835282392*^9, 3.7617408539123535`*^9}, {3.7617408938513727`*^9, 
   3.7617409168019505`*^9}, {3.761740951139127*^9, 3.7617409615622454`*^9}, {
   3.761741119825877*^9, 3.761741137098731*^9}, {3.7617411846664906`*^9, 
   3.7617412628827868`*^9}, {3.761741308873763*^9, 3.7617413140728617`*^9}, {
   3.761741370730278*^9, 3.7617413776657515`*^9}, {3.7617414310150013`*^9, 
   3.76174145343305*^9}, {3.761741514226403*^9, 3.761741522792517*^9}, 
   3.7617417195620637`*^9, {3.761741761583665*^9, 3.76174176295898*^9}, {
   3.761741800809732*^9, 3.7617418244285536`*^9}, 3.761742810016183*^9, 
   3.7617428407589483`*^9, {3.76174287795944*^9, 3.761742912946875*^9}, {
   3.761742963336087*^9, 3.7617430294070034`*^9}, {3.7617434911367626`*^9, 
   3.761743528885823*^9}, {3.7617435589284253`*^9, 3.7617435593503284`*^9}, 
   3.7617452764122887`*^9, {3.761745694334489*^9, 3.7617457035887346`*^9}, {
   3.762959505283737*^9, 3.7629595713260603`*^9}, {3.762959602339146*^9, 
   3.7629596083969436`*^9}, {3.7629597006710844`*^9, 3.762959721670905*^9}, {
   3.76295977035023*^9, 3.7629597706524076`*^9}, {3.7629598775820503`*^9, 
   3.762959881388866*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"37f5d4d4-f15e-4b4a-87a0-96ea200d4275"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MeasuredQCMLevel", "[", 
   RowBox[{"qList_", ",", " ", "rList_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "qrSplitResult", ",", "currentrList", ",", "  ", "newqList", ",", " ", 
      "newrList"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "QR", " ", "decompose", " ", "each", " ", "q", " ", "matrix", " ", 
      "from", " ", "the", " ", "last", " ", "iteration", " ", "and", " ", 
      "flatten", " ", "the", " ", "result", " ", "in", " ", "to", " ", "a", 
      " ", "long", " ", "list"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"qrSplitResult", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"QRSplit", ",", " ", "qList"}], "]"}], ",", "1"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Pick", " ", "the", " ", "r", " ", "matrices", " ", "and", " ", 
        "concatenate", " ", "every", " ", "two", " ", "of", " ", "them"}], 
       ",", " ", 
       RowBox[{"append", " ", "the", " ", "list", " ", 
        RowBox[{"{", 
         RowBox[{"ri1", ",", "ri2", ",", 
          RowBox[{"ri3", "..."}]}], "}"}], " ", "to", " ", "the", " ", 
        "exisiting", " ", "rList"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"newrList", " ", "=", " ", 
      RowBox[{"Append", "[", 
       RowBox[{"rList", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}], " ", "/@", " ", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"qrSplitResult", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", 
              RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}], ",", "2"}], 
          "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Pick", " ", "the", " ", "q", " ", "matrices", " ", "in", " ", "a", " ",
        "list"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"newqList", " ", "=", "  ", 
      RowBox[{"qrSplitResult", "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;", 
         RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newqList", ",", "newrList"}], "}"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.761736925166616*^9, 3.7617369627341237`*^9}, {
   3.761737008757016*^9, 3.761737026219349*^9}, {3.7617372924890556`*^9, 
   3.7617374188202453`*^9}, {3.761737450357885*^9, 3.7617374750987387`*^9}, {
   3.7617375164451065`*^9, 3.761737551334485*^9}, {3.7617376088486395`*^9, 
   3.7617376692720118`*^9}, {3.761737782253359*^9, 3.761737783652645*^9}, {
   3.761737824574155*^9, 3.761737958717331*^9}, 3.761740036516015*^9, 
   3.7617454114291525`*^9, {3.761745812613103*^9, 3.761745817259673*^9}, {
   3.7617461819010553`*^9, 3.761746237290985*^9}, {3.7617462839461517`*^9, 
   3.7617463984109697`*^9}, {3.761746480875413*^9, 3.7617464829309063`*^9}, {
   3.761746556483223*^9, 3.761746560458565*^9}, 3.7617466032199*^9, {
   3.7617466875872*^9, 3.76174670374135*^9}, {3.7617467338129325`*^9, 
   3.761746749290538*^9}, {3.761746807582584*^9, 3.761746872901718*^9}, {
   3.7617469046647906`*^9, 3.76174690481838*^9}, {3.761747465139044*^9, 
   3.7617474704428573`*^9}, {3.761747519539528*^9, 3.7617475285135517`*^9}, {
   3.762968917425428*^9, 3.762968928952589*^9}, {3.762969018337469*^9, 
   3.762969071451377*^9}, {3.7629691208871593`*^9, 3.7629691863601103`*^9}, {
   3.7629692307304077`*^9, 3.7629692623757486`*^9}, {3.7629693389459825`*^9, 
   3.7629695259097323`*^9}, {3.76296956543196*^9, 
   3.762969572847123*^9}},ExpressionUUID->"1187a008-4456-444b-a9da-\
076ea4eaff1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MeasuredQCM", "[", "krausList_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "m", ",", "k", ",", " ", "e2k", ",", "qrLoopNum", ",", " ", 
      "i", ",", "v", ",", "qList", ",", "rList"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", ",", "m"}], ")"}], " ", "=", " ", 
       RowBox[{"matrix", " ", "size"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"e2k", " ", "=", " ", 
       RowBox[{
        RowBox[{"kraus", " ", "rank", " ", "with", " ", "e2k"}], "=", 
        RowBox[{"2", "^", "k"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"qrLoopNum", " ", "=", " ", 
       RowBox[{
       "number", " ", "of", " ", "iteration", " ", "with", " ", "qr", " ", 
        "decomposition"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{
       "isometry", " ", "generated", " ", "from", " ", "all", " ", "Kraus", 
        " ", "operators"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"The", " ", "result", " ", "is", " ", "a", " ", "list", " ", 
       RowBox[{"{", 
        RowBox[{"qList", ",", "rList"}], "}"}]}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"qList", " ", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "q1", ",", " ", "q2", ",", " ", "q3", ",", " ", "q4", ",", "..."}], 
         "}"}], "  ", "with", " ", 
        RowBox[{"2", "^", "qrLoopNum"}], " ", "matrix"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"rList", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "r1", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r21", ",", "r22"}], "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r31", ",", "r32", ",", "r33", ",", "r34"}], "}"}], 
          "..."}]}], "}"}]}]}], "\[IndentingNewLine]", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e2k", ",", "n", ",", "m"}], "}"}], " ", "=", " ", 
      RowBox[{"Dimensions", "[", "krausList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"k", " ", "=", " ", 
      RowBox[{"Log2", "[", "e2k", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m", "<", "n"}], ",", " ", 
       RowBox[{"qrLoopNum", " ", "=", " ", "k"}], ",", 
       RowBox[{"qrLoopNum", " ", "=", " ", 
        RowBox[{"n", "+", "k", "-", "m", "-", "1"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"v", " ", "=", "  ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"krausList", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"qList", " ", "=", " ", 
      RowBox[{"{", "v", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rList", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "have", " ", "to", " ", "make", " ", "sure", " ", "that", " ", "k", " ",
        "is", " ", "an", " ", 
       RowBox[{"integer", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "<", "k"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"qList", ",", " ", "rList"}], "}"}], "=", 
        RowBox[{"MeasuredQCMLevel", "[", 
         RowBox[{"qList", ",", " ", "rList"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"qList", ",", " ", "rList"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}], " "}]], "Input",
 CellChangeTimes->{{3.7617377864840765`*^9, 3.7617378194997277`*^9}, {
   3.7617379748013487`*^9, 3.761738003892516*^9}, {3.761738052689681*^9, 
   3.761738058012427*^9}, {3.7617381340280666`*^9, 3.761738150069158*^9}, {
   3.761738398747989*^9, 3.7617384010218787`*^9}, {3.7617384438014517`*^9, 
   3.761738573208374*^9}, {3.761738670003517*^9, 3.761738837678238*^9}, {
   3.7617389148922296`*^9, 3.761738917075367*^9}, {3.76173896753539*^9, 
   3.761738973253096*^9}, {3.7617390070437107`*^9, 3.761739100788925*^9}, {
   3.76173925359522*^9, 3.761739263836835*^9}, {3.761747374595267*^9, 
   3.76174740002524*^9}, {3.7617491702256966`*^9, 3.7617491703862667`*^9}, {
   3.7617494500720043`*^9, 3.761749456504767*^9}, 3.7617512296199136`*^9, {
   3.7629574622175756`*^9, 3.7629574702001476`*^9}, {3.762957620383648*^9, 
   3.7629576662887993`*^9}, {3.762957830664685*^9, 3.762957990832176*^9}, {
   3.7629580840478263`*^9, 3.76295843960859*^9}, {3.762958778830966*^9, 
   3.7629587894136534`*^9}, {3.762958853576043*^9, 3.762959268666835*^9}, {
   3.7629676846354847`*^9, 3.7629677084323125`*^9}, {3.7629697597301655`*^9, 
   3.762969779574246*^9}, {3.762969939926265*^9, 3.762969955279194*^9}, 
   3.76297007927248*^9, {3.7629702369516497`*^9, 3.762970237958955*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"4d31936d-f5c5-4a93-a77e-6c45e4d5ce00"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecChannelRecursively", "[", "krausList_", "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "e2k", ",", "n", ",", "m", ",", "v", ",", "r1", ",", "q1", ",", "r2", 
      ",", "q2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e2k", ",", "n", ",", "m"}], "}"}], " ", "=", " ", 
      RowBox[{"Dimensions", "[", "krausList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"v", " ", "=", "  ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"krausList", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r1", ",", "q1", ",", "r2", ",", "q2"}], "}"}], " ", "=", " ", 
      RowBox[{"QRSplit", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"r1", ",", "r2"}], "]"}], ",", 
       RowBox[{"Partition", "[", 
        RowBox[{"q1", ",", "n"}], "]"}], ",", 
       RowBox[{"Partition", "[", 
        RowBox[{"q2", ",", "n"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "q1", " ", "q2", " ", "could", " ", "be", " ", "decomposed", " ", 
     "later"}], " ", "*)"}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.76297025185478*^9, {3.762970290006715*^9, 3.7629702995581617`*^9}, {
   3.7629703631510353`*^9, 3.7629703873084087`*^9}, {3.7629710158607793`*^9, 
   3.7629710843705015`*^9}, {3.762971204861157*^9, 3.762971213628702*^9}, {
   3.7629712597015266`*^9, 
   3.7629712730458307`*^9}},ExpressionUUID->"bf9400e4-112f-455e-ad27-\
b1570cb960bc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"krausList", " ", "=", " ", 
  RowBox[{"RPickRandomChannel", "[", 
   RowBox[{"2", ",", "4", ",", "4"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.762345226235097*^9, {3.76295773396966*^9, 3.762957742377147*^9}, {
   3.7629584774792767`*^9, 3.7629585011808696`*^9}, {3.762958616453359*^9, 
   3.7629586774312315`*^9}, {3.762958798359782*^9, 3.762958804997046*^9}, 
   3.7629689996654215`*^9},
 CellLabel->
  "In[207]:=",ExpressionUUID->"6aa016f4-c810-44a1-beae-1de455e59c51"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.18396889024069`", ",", "0.3566138746439067`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.3986546917168834`", ",", "0.22281326960585973`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.12323336447825374`", ",", "0.12935302033661175`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.2260943534345638`"}], ",", "0.22841668098803036`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.37665754188567346`", ",", "0.1825987305520381`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.26686809932469824`"}], ",", "0.17218233146244227`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.18358347747372472`"}], ",", "0.23893082658999515`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.14411921088914306`", ",", "0.2875371513492605`"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.01886247381017142`", ",", "0.017810794040872144`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.29708201792338906`", ",", "0.13436770545221965`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.16332384112066298`", ",", "0.15462336292517292`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.21468468458051249`"}], ",", "0.34281875363133246`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.20070429749097596`", ",", "0.34872627859902855`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.4313711156291747`"}], ",", "0.293578512276416`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.2867955311786994`"}], ",", "0.3176923036844874`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.05804652165996908`", ",", "0.2880764748713832`"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7617500313671465`*^9, 3.7623353828261967`*^9, 3.7623452299371986`*^9, 
   3.7629571075016623`*^9, {3.762957735701007*^9, 3.7629577432198925`*^9}, {
   3.7629584584442005`*^9, 3.7629585024933586`*^9}, {3.762958617450691*^9, 
   3.7629586458327627`*^9}, 3.7629586780665283`*^9, {3.7629587842773943`*^9, 
   3.7629588053759904`*^9}, 3.7629595805474186`*^9, 3.762959616690753*^9, 
   3.7629597439293575`*^9, 3.762959886504181*^9, 3.762968940804912*^9, {
   3.762969000709628*^9, 3.7629690476989217`*^9}, 3.7629691907433825`*^9, 
   3.762969272350065*^9, 3.762970084628153*^9},
 CellLabel->
  "Out[207]=",ExpressionUUID->"4e902d86-cff5-4c5c-be20-a0df5af7fe54"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"result", " ", "=", " ", 
  RowBox[{
   RowBox[{"MeasuredQCM", "[", "krausList", "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7617496464813423`*^9, 3.761749675950652*^9}, {
   3.7623452627215776`*^9, 3.762345278926222*^9}, 3.7629584878555183`*^9, {
   3.7629692794650307`*^9, 3.7629692802559147`*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"41ec07a0-d058-43fd-849e-7267184e40fa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.7256982575596331`"}], ",", 
        RowBox[{"-", "0.19172072072316304`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.`", ",", "0.6416567329485914`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.6880131095952406`"}], ",", "0.20222200860202788`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.`", ",", 
        RowBox[{"-", "0.7145810391719699`"}]}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.7013856395392531`", ",", 
         RowBox[{"-", "0.1539614363039084`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.`", ",", "0.6816663834643358`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.7127820035944462`", ",", "0.15149981329753096`"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0.`", ",", 
         RowBox[{"-", "0.6990526620768311`"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.5838819631992359`", ",", "0.13705251282363012`"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0.`", ",", "0.5587169950334525`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.8118385634167706`", ",", 
         RowBox[{"-", "0.09856946178075165`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.`", ",", "0.8119950673457139`"}], "}"}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7617496618272924`*^9, 3.761749676467271*^9}, 
   3.7623353848847647`*^9, {3.7623452529476767`*^9, 3.7623452795106583`*^9}, {
   3.7629571090116224`*^9, 3.7629571268748364`*^9}, {3.762958460111739*^9, 
   3.7629585042386894`*^9}, 3.7629586214629574`*^9, 3.762958683574794*^9, {
   3.7629587867318573`*^9, 3.762958807654894*^9}, 3.7629595826707106`*^9, 
   3.7629596185787015`*^9, 3.762959745807334*^9, 3.762959887705967*^9, 
   3.762968941753374*^9, {3.7629690021986465`*^9, 3.7629690484319596`*^9}, 
   3.7629691917756214`*^9, {3.76296927448635*^9, 3.76296928135697*^9}, 
   3.7629700862129126`*^9},
 CellLabel->
  "Out[208]=",ExpressionUUID->"a0522204-1ad4-4a85-adb6-f1322c219741"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"result", "[", 
  RowBox[{"[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7629587190588655`*^9, 3.762958749710843*^9}, {
  3.762969305356764*^9, 3.7629693054963913`*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"3d0c5e51-f455-46e4-82c9-33de2d223ca1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.7013856395392531`", ",", 
       RowBox[{"-", "0.1539614363039084`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.6816663834643358`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.7127820035944462`", ",", "0.15149981329753096`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", 
       RowBox[{"-", "0.6990526620768311`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.5838819631992359`", ",", "0.13705251282363012`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.5587169950334525`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.8118385634167706`", ",", 
       RowBox[{"-", "0.09856946178075165`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.8119950673457139`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.762958722666036*^9, 3.7629587501446805`*^9}, 
   3.7629588095478296`*^9, 3.7629689428753967`*^9, 3.762969003269779*^9, 
   3.762969049166993*^9, {3.7629692871734085`*^9, 3.7629693059452677`*^9}, 
   3.7629700872092466`*^9},
 CellLabel->
  "Out[209]=",ExpressionUUID->"a58e58d5-26d0-4577-bafe-563c3fd33d97"]
}, Open  ]],

Cell["4 q matrices :", "Text",
 CellChangeTimes->{{3.7617499275138626`*^9, 
  3.7617499416151423`*^9}},ExpressionUUID->"aaf22bd3-28b0-4a45-86a2-\
95feae5ae1e0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<", "5"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"result", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "i"}], "]"}], "]"}], "//", "MatrixForm"}], " ", 
     "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7617496827753987`*^9, 3.7617497914947033`*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"f12c1f99-0fc0-4a0a-91db-21806a8c4ec3"],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.9003286144077534`"}], "0.43521073754977`"},
     {"0.43521073754977`", "0.9003286144077535`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.7617497685430083`*^9, 3.7617497921040735`*^9}, 
   3.7623353875954742`*^9, {3.762957113088715*^9, 3.7629571294030724`*^9}, 
   3.762958463068856*^9, 3.7629597516272755`*^9},
 CellLabel->
  "During evaluation of \
In[119]:=",ExpressionUUID->"3e7e1e24-6077-431a-9e3f-d80b646c3891"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.8503187897479074`"}], 
      RowBox[{"-", "0.5262679505742809`"}]},
     {
      RowBox[{"-", "0.5262679505742809`"}], "0.8503187897479075`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.7617497685430083`*^9, 3.7617497921040735`*^9}, 
   3.7623353875954742`*^9, {3.762957113088715*^9, 3.7629571294030724`*^9}, 
   3.762958463068856*^9, 3.762959751633259*^9},
 CellLabel->
  "During evaluation of \
In[119]:=",ExpressionUUID->"f90f9ada-5b2d-4a9b-8461-c6048dbe7f2c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.8800126962950792`"}], "0.4749501598688693`"},
     {"0.4749501598688693`", "0.8800126962950793`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.7617497685430083`*^9, 3.7617497921040735`*^9}, 
   3.7623353875954742`*^9, {3.762957113088715*^9, 3.7629571294030724`*^9}, 
   3.762958463068856*^9, 3.7629597516402407`*^9},
 CellLabel->
  "During evaluation of \
In[119]:=",ExpressionUUID->"a8ef8baf-3e3b-4b0f-a7eb-990e3a6ed268"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.27489473902626704`"}], 
      RowBox[{"-", "0.9614743275073342`"}]},
     {
      RowBox[{"-", "0.9614743275073342`"}], "0.27489473902626704`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.7617497685430083`*^9, 3.7617497921040735`*^9}, 
   3.7623353875954742`*^9, {3.762957113088715*^9, 3.7629571294030724`*^9}, 
   3.762958463068856*^9, 3.7629597516432323`*^9},
 CellLabel->
  "During evaluation of \
In[119]:=",ExpressionUUID->"25592c01-a5d7-4849-8a18-871e89fc8673"]
}, Open  ]]
}, Open  ]],

Cell[BoxData["\[AliasDelimiter]"], "Input",
 CellChangeTimes->{
  3.762957447924599*^9},ExpressionUUID->"78a57f7a-85b2-49f0-ab0d-\
801153560001"],

Cell["2 * 4 r matrices:", "Text",
 CellChangeTimes->{{3.7617498938100176`*^9, 
  3.761749959734758*^9}},ExpressionUUID->"c5e85b62-0b60-4ac8-b9c4-\
849a700c3216"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<", "3"}], ",", 
    RowBox[{"i", "++"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{"result", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7617498175200596`*^9, 3.76174986261845*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"1a5fc7bc-be81-4b3e-99c8-9d7766eabcf4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.6487064040145105`"}], ",", 
       RowBox[{"-", "0.38319158446372736`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.39918280383512017`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.7610387647095008`", ",", 
       RowBox[{"-", "0.32663097641415595`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", 
       RowBox[{"-", "0.766243762757809`"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.7617498188983727`*^9, 3.7617498633844037`*^9}, 
   3.7623353899900436`*^9},
 CellLabel->
  "During evaluation of \
In[9]:=",ExpressionUUID->"3846fa17-e029-4f34-a9ea-21f703b7627c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.855316564561603`", ",", "0.23109538778738808`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", 
       RowBox[{"-", "0.7262256176665085`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.5181057559866878`", ",", 
       RowBox[{"-", "0.38150456906604785`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.5231114009176483`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.6988137212216664`", ",", 
       RowBox[{"-", "0.5633448986815061`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", 
       RowBox[{"-", "0.5644650201051727`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.7153036998592467`", ",", "0.5503580438019973`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", 
       RowBox[{"-", "0.24724034830429556`"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.7617498188983727`*^9, 3.7617498633844037`*^9}, 
   3.7623353899960275`*^9},
 CellLabel->
  "During evaluation of \
In[9]:=",ExpressionUUID->"fdcda5a9-d18b-42f2-ad51-fd056dc2adc7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"v", " ", "=", "  ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"krausList", ",", "1"}], "]"}]}]], "Input",
 CellLabel->
  "In[216]:=",ExpressionUUID->"63ea91d8-da59-4d3c-a17e-9bfbe009b486"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.18396889024069`", ",", "0.3566138746439067`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3986546917168834`", ",", "0.22281326960585973`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.12323336447825374`", ",", "0.12935302033661175`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.2260943534345638`"}], ",", "0.22841668098803036`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.37665754188567346`", ",", "0.1825987305520381`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.26686809932469824`"}], ",", "0.17218233146244227`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.18358347747372472`"}], ",", "0.23893082658999515`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.14411921088914306`", ",", "0.2875371513492605`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.01886247381017142`", ",", "0.017810794040872144`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.29708201792338906`", ",", "0.13436770545221965`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.16332384112066298`", ",", "0.15462336292517292`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.21468468458051249`"}], ",", "0.34281875363133246`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.20070429749097596`", ",", "0.34872627859902855`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.4313711156291747`"}], ",", "0.293578512276416`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.2867955311786994`"}], ",", "0.3176923036844874`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.05804652165996908`", ",", "0.2880764748713832`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7629708184113584`*^9},
 CellLabel->
  "Out[216]=",ExpressionUUID->"d243c2c7-f5ab-416c-bcc5-427594a58e0a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"r1", ",", "q1", ",", "r2", ",", "q2"}], "}"}], " ", "=", " ", 
  RowBox[{"QRSplit", "[", "v", "]"}]}]], "Input",
 CellChangeTimes->{{3.7629708292842712`*^9, 3.7629708576693335`*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"2c15d24a-8cc2-4656-b55c-6748a23d0a1b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.7256982575596331`"}], ",", 
       RowBox[{"-", "0.19172072072316304`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.6416567329485914`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.25350603825250695`"}], ",", "0.4800253756663065`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5493394638392453`"}], ",", "0.18310960618617414`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.16981350471015458`"}], ",", "0.15085363848712216`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.31155421840872316`", ",", "0.4490688953914218`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5190277611417886`"}], ",", "0.12949346565535347`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.36773975484262306`", ",", "0.3782172769920468`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.25297494593837994`", ",", "0.44795192007006207`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.1985938499753119`"}], ",", "0.38877889452582526`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.6880131095952406`"}], ",", "0.20222200860202788`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", 
       RowBox[{"-", "0.7145810391719699`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.027415863952459096`"}], ",", 
       RowBox[{"-", "0.03268332608427621`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.43179703087076776`"}], ",", 
       RowBox[{"-", "0.31023292837461836`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.23738478067190708`"}], ",", 
       RowBox[{"-", "0.2835616661743438`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.31203574697408293`", ",", 
       RowBox[{"-", "0.3914437170719313`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.2917158040913648`"}], ",", 
       RowBox[{"-", "0.5705687837950306`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.6269809537247787`", ",", 
       RowBox[{"-", "0.23340832644012668`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.4168460268837344`", ",", 
       RowBox[{"-", "0.32662056513665033`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.08436833666457018`"}], ",", 
       RowBox[{"-", "0.42701610124960343`"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.762970829943507*^9, 3.76297085793263*^9}},
 CellLabel->
  "Out[218]=",ExpressionUUID->"d3836d4a-2f4f-49a1-b860-161cf9a7f423"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Join", "[", 
  RowBox[{"r1", ",", "r2"}], "]"}]], "Input",
 CellChangeTimes->{{3.762970863306254*^9, 3.762970903118661*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"a02398fa-3040-4eaf-9b33-4298b5ea9e0a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7256982575596331`"}], ",", 
     RowBox[{"-", "0.19172072072316304`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.6416567329485914`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.6880131095952406`"}], ",", "0.20222200860202788`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "0.7145810391719699`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7629708640652237`*^9, 3.7629709097219915`*^9}},
 CellLabel->
  "Out[223]=",ExpressionUUID->"abb61450-0781-4545-a5fb-54dd94d788f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"e2k", ",", "n", ",", "m"}], "}"}], " ", "=", " ", 
  RowBox[{"Dimensions", "[", "krausList", "]"}]}]], "Input",
 CellChangeTimes->{{3.7629709518300457`*^9, 3.762970957021158*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"914d1fd5-33d3-4683-bccd-3bd709dc62e5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.7629709655832844`*^9},
 CellLabel->
  "Out[226]=",ExpressionUUID->"a61baa0a-02b1-42ac-88ad-cda93b2f46c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Partition", "[", 
  RowBox[{"q1", ",", "n"}], "]"}]], "Input",
 CellChangeTimes->{{3.7629709604460273`*^9, 3.762970988462077*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"26b6d862-05cf-4d43-a5db-3840b74d0c75"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.25350603825250695`"}], ",", "0.4800253756663065`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5493394638392453`"}], ",", "0.18310960618617414`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.16981350471015458`"}], ",", "0.15085363848712216`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.31155421840872316`", ",", "0.4490688953914218`"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.5190277611417886`"}], ",", "0.12949346565535347`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.36773975484262306`", ",", "0.3782172769920468`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.25297494593837994`", ",", "0.44795192007006207`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.1985938499753119`"}], ",", "0.38877889452582526`"}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7629709891402645`*^9},
 CellLabel->
  "Out[227]=",ExpressionUUID->"79c0b39d-a49f-468e-9fa8-19caf013e933"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DecChannelRecursively", "[", "krausList", "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.762971123235526*^9, 3.7629711744156065`*^9}},
 CellLabel->
  "In[234]:=",ExpressionUUID->"1652a19b-aa2c-45e5-bbdf-20be341e7c21"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7256982575596331`"}], ",", 
     RowBox[{"-", "0.19172072072316304`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.6416567329485914`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.6880131095952406`"}], ",", "0.20222200860202788`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "0.7145810391719699`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7629711305788813`*^9, 3.7629711750718513`*^9}},
 CellLabel->
  "Out[234]=",ExpressionUUID->"eb910894-c84f-4920-a9ce-9e5e01e78cad"]
}, Open  ]],

Cell["What is the cost of flatten and partition", "Section",
 CellChangeTimes->{{3.762970185052496*^9, 
  3.7629702011584053`*^9}},ExpressionUUID->"634da45f-756d-47a0-ab2d-\
9e5d4f23c146"],

Cell["Do we require that the number of kraus operators is 2^k", "Section",
 CellChangeTimes->{{3.762971477225597*^9, 3.7629714923800554`*^9}, 
   3.7629717827452574`*^9},ExpressionUUID->"ba5d60e7-52ab-4904-8eb9-\
b41c0caa2bc1"]
},
WindowSize->{958, 988},
WindowMargins->{{Automatic, -4}, {Automatic, 0}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 289, 5, 28, "Input",ExpressionUUID->"92422b64-8977-4de9-a861-4e51815262eb"],
Cell[872, 29, 449, 6, 32, "Output",ExpressionUUID->"c35e3d44-9bfe-43f6-ba69-19f57ba42b4e"]
}, Open  ]],
Cell[1336, 38, 251, 5, 28, "Input",ExpressionUUID->"c8273595-1fe1-41fa-9daf-4ea21b66a83f"],
Cell[1590, 45, 3436, 64, 143, "Input",ExpressionUUID->"37f5d4d4-f15e-4b4a-87a0-96ea200d4275"],
Cell[5029, 111, 3833, 80, 200, "Input",ExpressionUUID->"1187a008-4456-444b-a9da-076ea4eaff1e"],
Cell[8865, 193, 5077, 112, 428, "Input",ExpressionUUID->"4d31936d-f5c5-4a93-a77e-6c45e4d5ce00"],
Cell[13945, 307, 1700, 41, 162, "Input",ExpressionUUID->"bf9400e4-112f-455e-ad27-b1570cb960bc"],
Cell[CellGroupData[{
Cell[15670, 352, 499, 10, 28, "Input",ExpressionUUID->"6aa016f4-c810-44a1-beae-1de455e59c51"],
Cell[16172, 364, 2724, 74, 90, "Output",ExpressionUUID->"4e902d86-cff5-4c5c-be20-a0df5af7fe54"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18933, 443, 444, 9, 28, "Input",ExpressionUUID->"41ec07a0-d058-43fd-849e-7267184e40fa"],
Cell[19380, 454, 2285, 57, 71, "Output",ExpressionUUID->"a0522204-1ad4-4a85-adb6-f1322c219741"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21702, 516, 284, 6, 28, "Input",ExpressionUUID->"3d0c5e51-f455-46e4-82c9-33de2d223ca1"],
Cell[21989, 524, 1275, 34, 52, "Output",ExpressionUUID->"a58e58d5-26d0-4577-bafe-563c3fd33d97"]
}, Open  ]],
Cell[23279, 561, 160, 3, 34, "Text",ExpressionUUID->"aaf22bd3-28b0-4a45-86a2-95feae5ae1e0"],
Cell[CellGroupData[{
Cell[23464, 568, 517, 15, 28, "Input",ExpressionUUID->"f12c1f99-0fc0-4a0a-91db-21806a8c4ec3"],
Cell[CellGroupData[{
Cell[24006, 587, 976, 24, 35, "Print",ExpressionUUID->"3e7e1e24-6077-431a-9e3f-d80b646c3891"],
Cell[24985, 613, 1022, 26, 35, "Print",ExpressionUUID->"f90f9ada-5b2d-4a9b-8461-c6048dbe7f2c"],
Cell[26010, 641, 980, 24, 35, "Print",ExpressionUUID->"a8ef8baf-3e3b-4b0f-a7eb-990e3a6ed268"],
Cell[26993, 667, 1026, 26, 35, "Print",ExpressionUUID->"25592c01-a5d7-4849-8a18-871e89fc8673"]
}, Open  ]]
}, Open  ]],
Cell[28046, 697, 145, 3, 28, "Input",ExpressionUUID->"78a57f7a-85b2-49f0-ab0d-801153560001"],
Cell[28194, 702, 161, 3, 34, "Text",ExpressionUUID->"c5e85b62-0b60-4ac8-b9c4-849a700c3216"],
Cell[CellGroupData[{
Cell[28380, 709, 459, 12, 28, "Input",ExpressionUUID->"1a5fc7bc-be81-4b3e-99c8-9d7766eabcf4"],
Cell[CellGroupData[{
Cell[28864, 725, 793, 24, 22, "Print",ExpressionUUID->"3846fa17-e029-4f34-a9ea-21f703b7627c"],
Cell[29660, 751, 1258, 37, 41, "Print",ExpressionUUID->"fdcda5a9-d18b-42f2-ad51-fd056dc2adc7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30967, 794, 209, 5, 28, "Input",ExpressionUUID->"63ea91d8-da59-4d3c-a17e-9bfbe009b486"],
Cell[31179, 801, 1881, 51, 90, "Output",ExpressionUUID->"d243c2c7-f5ab-416c-bcc5-427594a58e0a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33097, 857, 317, 7, 28, "Input",ExpressionUUID->"2c15d24a-8cc2-4656-b55c-6748a23d0a1b"],
Cell[33417, 866, 2897, 85, 109, "Output",ExpressionUUID->"d3836d4a-2f4f-49a1-b860-161cf9a7f423"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36351, 956, 231, 5, 28, "Input",ExpressionUUID->"a02398fa-3040-4eaf-9b33-4298b5ea9e0a"],
Cell[36585, 963, 645, 18, 32, "Output",ExpressionUUID->"abb61450-0781-4545-a5fb-54dd94d788f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37267, 986, 314, 7, 28, "Input",ExpressionUUID->"914d1fd5-33d3-4683-bccd-3bd709dc62e5"],
Cell[37584, 995, 210, 5, 32, "Output",ExpressionUUID->"a61baa0a-02b1-42ac-88ad-cda93b2f46c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37831, 1005, 237, 5, 28, InheritFromParent,ExpressionUUID->"26b6d862-05cf-4d43-a5db-3840b74d0c75"],
Cell[38071, 1012, 1227, 38, 52, "Output",ExpressionUUID->"79c0b39d-a49f-468e-9fa8-19caf013e933"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39335, 1055, 284, 6, 28, "Input",ExpressionUUID->"1652a19b-aa2c-45e5-bbdf-20be341e7c21"],
Cell[39622, 1063, 645, 18, 32, "Output",ExpressionUUID->"eb910894-c84f-4920-a9ce-9e5e01e78cad"]
}, Open  ]],
Cell[40282, 1084, 188, 3, 67, "Section",ExpressionUUID->"634da45f-756d-47a0-ab2d-9e5d4f23c146"],
Cell[40473, 1089, 227, 3, 53, "Section",ExpressionUUID->"ba5d60e7-52ab-4904-8eb9-b41c0caa2bc1"]
}
]
*)

